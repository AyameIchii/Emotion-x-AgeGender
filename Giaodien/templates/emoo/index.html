<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nh·∫≠n di·ªán C·∫£m x√∫c</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='emoo/style.css') }}">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Nh·∫≠n di·ªán C·∫£m x√∫c</h1>
      <p>Upload ·∫£nh ho·∫∑c d√πng webcam ƒë·ªÉ ph√¢n t√≠ch c·∫£m x√∫c</p>
    </div>

    <!-- Upload area -->
    <div class="upload-area" onclick="document.getElementById('imageInput').click()">
      <div class="upload-text">üìÇ Upload ·∫£nh</div>
      <div class="upload-subtext">H·ªó tr·ª£ JPG, PNG (ho·∫∑c k√©o th·∫£)</div>
      <input type="file" id="imageInput" accept="image/*" style="display: none;" />
    </div>

    <!-- Buttons -->
    <div style="text-align:center; margin-bottom: 10px;">
      <button class="btn" id="processBtn" onclick="processImage()" disabled>üîç D·ª± ƒëo√°n</button>
      <a href="{{ url_for('home') }}">üè† V·ªÅ Trang Ch·ªçn</a>
    </div>

    <!-- Loading -->
    <div id="loading" style="display:none; text-align:center; margin:20px;">
      <div class="spinner"></div>
      <p style="color:#fb7185; margin-top:10px;">ƒêang x·ª≠ l√Ω...</p>
    </div>

    <!-- Preview + Result -->
    <div id="previewContainer" style="display:none; margin-top:20px; gap:20px; justify-content:center; flex-wrap:wrap; display:flex;">

      <!-- Original -->
<div class="model-result" id="origResult" style="display:none;">
  <h3>·∫¢nh g·ªëc</h3>
  <img id="originalImage" src="" alt="Original Image">
  <p id="fileNamePreview" style="margin-top:8px; color:#555; font-style:italic;"></p>
</div>


      <!-- Deep Learning result -->
      <div class="model-result" id="deepResult" style="display:none;">
        <h3>Deep Learning (VGG16)</h3>
        <img id="deepImage" src="" alt="Deep Result">
      </div>

      <!-- Truy·ªÅn th·ªëng result -->
      <div class="model-result" id="tradResult" style="display:none;">
        <h3>Truy·ªÅn th·ªëng (SGD-SVM)</h3>
        <img id="tradImage" src="" alt="Trad Result">
      </div>

    </div>

    <!-- Error message -->
    <div id="errorMessage" style="color:red; display:none; text-align:center; margin-top:10px;"></div>

    <!-- Text results -->
    <div id="resultText" style="margin-top:20px; text-align:center;"></div>

    <!-- Reset -->
    <div style="text-align:center; margin-top:20px; display:none;" id="resetSection">
      <button class="btn" onclick="resetUpload()">üîÑ Upload ·∫£nh m·ªõi</button>
    </div>

    <!-- Webcam toggle -->
    <div style="text-align:center; margin-top:30px;">
      <button class="btn" onclick="toggleWebcam()">üé• B·∫≠t/T·∫Øt Webcam (Emotion)</button>
      <div id="webcamContainer" style="display:none; margin-top:15px; text-align:center;">
  <div class="webcam-wrapper">
    <img id="webcamStream" width="600" />
  </div>
</div>

    </div>

    <script>
      function toggleWebcam() {
  const container = document.getElementById("webcamContainer");
  const stream = document.getElementById("webcamStream");
  const uploadArea = document.querySelector(".upload-area");
  const processBtn = document.getElementById("processBtn");
  const fileName = document.getElementById("fileName");

  if (container.style.display === "none") {
    // B·∫≠t webcam
    container.style.display = "block";
    stream.src = "/video_feed_emotion";

    // ·∫®n ph·∫ßn upload + n√∫t d·ª± ƒëo√°n
    uploadArea.style.display = "none";
    processBtn.style.display = "none";
    fileName.style.display = "none";
  } else {
    // T·∫Øt webcam
    container.style.display = "none";
    stream.src = "";

    // Hi·ªán l·∫°i ph·∫ßn upload + n√∫t d·ª± ƒëo√°n
    uploadArea.style.display = "block";
    processBtn.style.display = "inline-block"; // cho ƒë·∫πp
    fileName.style.display = "block";
  }
}
    </script>

    <script src="{{ url_for('static', filename='emoo/script.js') }}"></script>
  </div>
</body>
</html>
